[{"title":"noteexpress2endnotes","url":"/2022/01/06/noteexpress2endnotes/","content":"noteexpress2endnotes\nnoteexpress2endnote.py想法：因为我习惯用noteexpress看文献，就用它插入文献也方便一些，但是老师用的是endnotes，他想看我的参考文献就很困难，所以做了这个小工具用法：先用noteexpress插入文献，使用含有doi号的格式，将参考文献部分的文字复制到一个txt文件中，去掉空行和“参考文献”，使用小程序，在程序中改输入输出文件的路径，执行，将输出文件导入到endnotes里，选择ris，utf-8，导入，最后查找全文，更新文献，就能得到完整的记录了。我已用开题报告为例，执行了一下，总共有50篇期刊文章，只有11篇没有更新到数据，应该是没有doi号，并且是从谷歌学术上下载的。问题：目前只能对英文期刊文章进行处理，并且有些不能找到直接完整信息，后面需要手动的从谷歌学术上下载，没有接口，使用比较难。 \n","categories":["tools"],"tags":["python"]},{"title":"Annotation Evaluation","url":"/2022/03/10/Annotation-Evaluation/","content":"基因注释评估基因注释评估的必要性基因组计划的一个基本目标是得到准确的基因结构注释，但是有些难以实现，即使是人类基因组，拥有最为丰富的研究资源，但是几个基因组数据库中的基因注释信息都有所不同，并不能说哪一套基因注释是完整的、精准的。 许多基因组有多次的重新注释，在这种情况下，需要比较不同的注释版本。此外，现有许多基因预测工具，它们对同一基因组注释会产生不同的注释结果，预测软件开发者可以通过基因注释评估发现预测软件的可扩展性（可能软件对一些物种准确，但对其他物种不准确），通过评估不同参数设置下的注释结果揭示那些参数需要调整。现有不同的基因注释程序的作者使用不同的度量，使注释结果的比较变得复杂，需要一个标准的工具进行比较。\n人工现有一些基因组浏览器可以直接访问基因注释的结果，可以精细的对比不同版本的基因注释，但是这个方法很慢、容易出错、不自动化、不精确、对于研究资源有限的物种的注释结果的比较没有可扩展性。\n数量和长度这是一种常规的手段，在基因模型的数量、外显子水平、转录本水平上统计数量和平均长度。GenomeQC1发表于2020年，有命令行版和网页版，但是网页版需要压缩的基因组文件和注释文件都小于1Gb.此外，GenomeQC还包括BUSCO计算基因注释的完整性。\n特异性和灵敏度混淆矩阵和计算方法2  \n\n\n\n混淆矩阵\n预测值=1\n预测值=0\n\n\n\n真实值=1\nTP\nFN\n\n\n真实值=0\nFP\nTN\n\n\n灵敏度= $$\\frac{TP}{TP+FN}$$特异性= $$\\frac{TN}{TN+FP}$$准确性= $$\\frac{TP+TN}{TP+TN+FP+FN}$$精密度= $\\frac{TP}{TP+FP}$F_1= $\\frac{2TP}{2TP+FP+FN}$FDR(假发现率)= $$\\frac{FP}{TP+FP}$$  \n以上是模型评估中用到的评估公式，但是和基因注释中说到的特异性和灵敏度的内涵有所不同。  \n不同基因注释版本的比较与金标准比较[GFPE] (下载地址：ftp://anonymous@iubio.bio.indiana.edu/molbio/genefind/)3发表于2003年，可以在编码水平、外显子水平和蛋白质水平统计灵敏度、特异性和F1值（具体计算方式文章中没有讲）。使用时需要指定一个注释文件为参考，另一个为预测，并认为参考是完全正确。这篇文章的创新点：将拼接边界完全准确预测定义为“类型1”，正确预测至少一个剪接边界的为”类型2”，外显子重叠超过某个阈值的为”类型3”。*表示只有类型1的，**表示类型1和类型2，***表示类型1+类型2+类型3，分别计算它们的灵敏度和特异性。\nEval4发表于2003年指标包括上述的常规特征（编码、基因组、外显子、内含子平均长度以及外显子平均数量），敏感性和特异性。文章的创新点：  \n\n产生统计分布直方图，可以根据外显子或基因的长度或者GC含量进行分类，可视化各分类的统计数据，用户可以从图中得到例如该系统在长基因上表现不佳，在短基因上表现良好的信息。  \n产生韦恩图，比较多个注释预测的结果，将其中的子集提取出来，用可视化浏览器单独检查。  两两比较以上的评估方法是设定一个为参考，另一个为预测，来比较，但是在实际比较之前，我们很难说哪一个的质量相对较高，不同的注释会有互补的部分，如果以其中一个为参考，那么另一注释上互补的部分就被忽略了。ParEval5更新于2013年文章的创新点：\n同时考虑了参考注释和预测注释。  \n不在使用ATCG表示序列，而使用CFGIT表示基因结构简化分析，使用C表示编码序列，F表示5’-UTR，T表示3’-UTR，I表示内含子，G表示基因间序列，进行比较。\n每个基因座独立计算，可以并行运算，并报告每个基因座的比较结果。利用RNA-Seq评估GAAP6 更新于2012年GAAP利用RNA-Seq来评估基因组注释在基因水平、转录物水平、外显子水平、剪接位点和碱基水平上的的特异性（以注释的数量为分母，与模型评估常用的特异性的含义不同）和读段水平、剪切位点、外显子水平上的敏感性（具体计算的方法没有看明白）这篇文章有几个创新点：  \n用RNA-seq评估注释；  \n针对转录物含量低，无法获得连续read的，可以通过当前的覆盖深度和碱基覆盖率下通过模型判断转录物是否被读段完全支持；  \n计算剪切位点是否被完全支持，用到了匹配熵E，方法没看明白。文章用该流程比较了人类基因组的5个注释，RefSef是最为保守的。评估恒河猴的注释发现很不完整。  BUSCOBUSCO7是一组基准通用的单拷贝同源基因，常常被作为基因组组装和注释完整性的定量测量。GenomeQC1可以产生BUSCO堆叠图通过邮件发送给用户，可视化的图片可以让用户直观地比较两个注释的完整性。如：   \n\n  \n\nAED(注释编辑距离)虽然上述的灵敏度、特异性和准确性等质量指标可以便捷的评估基因注释流程的性能，但是它们是以参考基因模型的存在为前提的，ADE测量两个注释之间的距离，并且不会假设哪一个更正确。MAKER28中使用AED量化基因注释及其支持证据——EST、蛋白质和mRNA-Seq之间的一致性。AED的值在0~1之间，为0表示内含子外显子坐标与证据之间精确匹配，为1表示没有证据支持。  \n参考文献\n\n\n[1] Manchanda, N., et al., GenomeQC: a quality assessment tool for genome assemblies and gene structure annotations. BMC Genomics, 2020. 21(1).  \n\n\n\n\n[2]Ou S, Su W, Liao Y, et al. Benchmarking transposable element annotation methods for creation of a streamlined, comprehensive pipeline[J]. Genome Biology, 2019,20(1):275.\n\n\n\n\n[3]Wang, J. and E. Kraemer, GFPE: gene-finding program evaluation. Bioinformatics, 2003. 19(13): p. 1712-1713.  \n\n\n\n\n[4]Keibler, E. and M.R. Brent, Eval: a software package for analysis of genome annotations. BMC Bioinformatics, 2003. 4: p. 50.  \n\n\n\n\n[5]Standage, D.S. and V.P. Brendel, ParsEval: parallel comparison and analysis of gene structure annotations. BMC Bioinformatics, 2012. 13: p. 187.\n\n\n\n\n[6]王颖与刘麟, 一种基于RNA-Seq的基因组注解评估方法. 科学通报, 2013. 58(33): 第3471-3482页.  \n\n\n\n\n[7]Simão, F.A., et al., BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs. Bioinformatics, 2015. 31(19): p. 3210-3212.\n\n\n\n\n[8]Holt, C. and M. Yandell, MAKER2: an annotation pipeline and genome-database management tool for second-generation genome projects. BMC Bioinformatics, 2011. 12(1): p. 491.\n\n","categories":["Literature reading"],"tags":["software"]}]